<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="style.css">
<link rel="stylesheet" type="text/css" media="all" href="niceforms-default.css" />
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>
</head>
<body>
<div id="main_container">
	<div class="header">
    <div class="logo" margin-left="100px">
<h3>HỆ THỐNG QUẢN LÝ BÒ </h3>
<p>Thực hiện: nhóm 24HCB2</p>	
	</div>
    
    <div class="right_header">Welcome Admin, <a href="#">Visit site</a> | <a href="#" class="logout">Logout</a></div>
    </div>
    
    <div class="main_content">
    
                    <div class="menu">
                    <ul>
                    <li><a href="list.html">Quản lý bò<!--[if IE 7]><!--></a><!--<![endif]-->
                    <!--[if lte IE 6]><table><tr><td><![endif]-->
                        <ul>
                        <li><a href="#inforcows" onclick="inforcowsFunction()"  >Quản lý bò</a></li>
                        <li><a href="#reporthealth" title="">Quản lý sức khỏe bò</a></li>
						<li><a href="#getmilk" onclick="getmilkFunction()">Quản lý quy trình vắt sữa</a></li>
                        </ul>
                    <!--[if lte IE 6]></td></tr></table></a><![endif]-->
                    </li>
                    <li><a href="login.html">Quản lý nhân viên<!--[if IE 7]><!--></a><!--<![endif]-->
                    </li>
                    <li><a href="login.html">Quản lý trụ sở<!--[if IE 7]><!--></a><!--<![endif]-->
                    <!--[if lte IE 6]><table><tr><td><![endif]-->
                        <ul>
                        <li><a href="#unit" onclick="unitFunction()" >Quản lý trụ sở</a></li>
                        <li><a href="#coso" onclick="cosoFunction()" >Quản lý cơ sở</a></li>
                        <li><a href="#lodging" onclick="lodgingFunction()"  >Quản lý chuồng trại</a></li>
                     <!--[if lte IE 6]></td></tr></table></a><![endif]-->
                    </li>
                    </ul>
                    </div>
    <div class="center_content">  
    
    <div class="right_content">   


<form id="form_reports" style="display: none;" class="formshow" >
		<p> Báo cáo </p>
        <br />
        Nhập Tên TK cần tạo: <input type="text" id="txtTenThe" />
        <button id="btnDangKy" type="button">Rút tiền</button>
        <br></br>
</form>

<form id="form_getmilk" style="display: none;" class="formshow" >
		<p> Quy trình vắt sữa bò </p>  
</form>

<form id="form_inforcows" style="display: none;" class="formshow" >
		<p> Thông tin bò </p>  
</form>

<form id="form_unit" style="display: none;" class="formshow">
<h2>Quản lý trụ sở</h2>                  
<table id="rounded-corner" summary="2007 Major IT Companies' Profit">
    <thead>
    	<tr>
            <th scope="col" class="rounded">ID</th>
            <th scope="col" class="rounded">Trụ sở</th>
            <th scope="col" class="rounded">Edit</th>
            <th scope="col" class="rounded-q4">Delete</th>
        </tr>
    </thead>
    <tbody  id="stationList">
	
    </tbody>
</table>
<div class="pagination">
	<span class="disabled"><< prev</span><span class="current">1</span><a href="">2</a><a href="">3</a><a href="">4</a><a href="">5</a>…<a href="">10</a><a href="">11</a><a href="">12</a>...<a href="">100</a><a href="">101</a><a href="">next >></a>
</div> 
<h2>Thêm trụ sở</h2>

<div class="form">     
 <form action="" method="post" class="niceform">
	<fieldset>
		<dl>
			<dt><label for="TruSo">Trụ Sở</label></dt>
			<dd><input type="txtTruSo" class="form-control" id="txtTruSo" readonly placeholder="Trụ Sở"></dd>
		</dl>
		<dl>
			<dt><label for="DiaChiTruSo">Địa Chỉ</label></dt>
			<dd><input type="txtDiaChiTruSo" class="form-control" id="txtDiaChiTruSo" placeholder="Địa chỉ trụ sở"></dd>
		</dl>
		<dl class="submit">
		  <button type="button" class="btn btn-default" id="btnAddTruSo">Thêm</button>
		  <button type="button" class="btn btn-default" id="btnUpdateTruSo">Sửa</button>
		</dl>
	</fieldset>
 </form>
</div>
</form>

<form id="form_lodging" style="display: none;" class="formshow" >
		<p> Chuồng trại </p>  
</form>

<form id="form_CoSo" style="display: none;" class="formshow" >
	<h2>Quản lý cơ sở</h2>                  
	<table id="rounded-corner" summary="2007 Major IT Companies' Profit">
		<thead>
			<tr>
				<th scope="col" class="rounded">Mã cơ sở</th>
				<th scope="col" class="rounded">Địa chỉ</th>
				<th scope="col" class="rounded">Trụ sở</th>
				<th scope="col" class="rounded">Người quản lý</th>
				<th scope="col" class="rounded">Edit</th>
				<th scope="col" class="rounded-q4">Delete</th>
			</tr>
		</thead>
		<tbody  id="stationList1">
		
		</tbody>
	</table>
	<div class="pagination">
		<span class="disabled"><< prev</span><span class="current">1</span><a href="">2</a><a href="">3</a><a href="">4</a><a href="">5</a>…<a href="">10</a><a href="">11</a><a href="">12</a>...<a href="">100</a><a href="">101</a><a href="">next >></a>
	</div> 
	
	<h2>Thêm cơ sở</h2>

	<div class="form">     
	 <form action="" method="post" class="niceform">
		<fieldset>
			<dl>
				<dt><label for="MaCoSo">Cơ Sở</label></dt>
				<dd><input type="txtMaCoSo" class="form-control" id="txtMaCoSo" readonly placeholder="Mã Cơ Sở"></dd>
			</dl>
			<dl>
				<dt><label for="DiaChiCoSo">Địa Chỉ</label></dt>
				<dd><input type="txtDiaChiCoSo" class="form-control" id="txtDiaChiCoSo" placeholder="Địa chỉ Cơ sở"></dd>
			</dl>
			<dl>
				<dt><label for="TruSo">Trụ Sở</label></dt>
				<dd><input type="txtTruSo1" class="form-control" id="txtTruSo1" placeholder="Trụ sở"></dd>
			</dl>
			<dl>
				<dt><label for="NguoiQuanLy">Người Quản Lý</label></dt>
				<dd><input type="txtNguoiQuanLy" class="form-control" id="txtNguoiQuanLy" placeholder="Người quản lý"></dd>
			</dl>
			<dl class="submit">
			  <button type="button" class="btn btn-default" id="btnAddCoSo">Thêm</button>
			  <button type="button" class="btn btn-default" id="btnUpdateCoSo">Sửa</button>
			</dl>
		</fieldset>
	 </form>
	</div>
</form>
     
     </div><!-- end of right content-->                           
  </div>   <!--end of center content -->               
                    
    <div class="clear"></div>
    </div> <!--end of main content-->
</div>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript">


/* When the user clicks on the button, 
toggle between hiding and showing the dropdown content */
function myFunction() {
		document.getElementById("myDropdown").classList.toggle("show");
	}

function getmilkFunction(){
	document.getElementById("form_inforcows").style.display="none";
	document.getElementById("form_unit").style.display="none";
	document.getElementById("form_lodging").style.display="none";
	document.getElementById("form_CoSo").style.display="none";
	
	document.getElementById("form_getmilk").style.display="block";
}

function inforcowsFunction(){
	document.getElementById("form_unit").style.display="none";
	document.getElementById("form_lodging").style.display="none";
	document.getElementById("form_getmilk").style.display="none";
	document.getElementById("form_CoSo").style.display="none";
	
	document.getElementById("form_inforcows").style.display="block";
}

function unitFunction(){
	document.getElementById("form_lodging").style.display="none";
	document.getElementById("form_getmilk").style.display="none";
	document.getElementById("form_inforcows").style.display="none";
	document.getElementById("form_CoSo").style.display="none";
	
	document.getElementById("form_unit").style.display="block";
	
	$('#stationList').empty();
	getTruSo();
}

function cosoFunction(){
	document.getElementById("form_lodging").style.display="none";
	document.getElementById("form_getmilk").style.display="none";
	document.getElementById("form_inforcows").style.display="none";
	document.getElementById("form_unit").style.display="none";
	
	document.getElementById("form_CoSo").style.display="block";
	
	$('#stationList1').empty();
	getCoSo();
}

function lodgingFunction(){
	document.getElementById("form_getmilk").style.display="none";
	document.getElementById("form_inforcows").style.display="none";
	document.getElementById("form_unit").style.display="none";
	document.getElementById("form_CoSo").style.display="none";
	
	document.getElementById("form_lodging").style.display="block";
}


// Quản lý trụ sở
	function getTruSo(){
		var _url = 'http://localhost:2796/api/TruSo';
	   var maxstation = 1;
		$.ajax({
			url: _url,
			dataType: 'json',
			timeout: 30 * 1000
		})
		.done(function (data) {
			//console.log(data);
			$('#stationList').empty();
			$.each(data, function (index, dm) {
				var tr = '<tr>' +
							'<td>' + dm.MaTruSo + '</td>' +
							'<td>' + dm.DiaChiTruSo + '</td>' +
							'<td><a href="#" onclick="getTruSoAction('+ dm.MaTruSo +', '+ dm.DiaChiTruSo +')" ><img src="images/user_edit.png" alt="" title="" border="0" /></a></td>' +
							'<td><a href="#" onclick="deleteTruSoAction('+ dm.MaTruSo +')"><img src="images/trash.png" alt="" title="" border="0" /></a></td>' +
						+'</tr>';

				$('#stationList').append(tr);
				maxstation = dm.MaTruSo;
			});
			maxstation = maxstation + 1;
			$('#txtTruSo').val(maxstation);	
			$('#txtDiaChiTruSo').val("");
			$("#btnUpdateTruSo").prop("disabled",true);
			$("#btnAddTruSo").prop("disabled",false);
		})
		.fail(function (jqXHR, textStatus, error) {
			console.log(jqXHR);
			console.log(jqXHR.statusCode);
		});
	};

	$('#btnAddTruSo').on('click', function () {
		var stationNo = $('#txtTruSo').val();
		var address = $('#txtDiaChiTruSo').val();
		
		var _url = 'http://localhost:2796/api/TruSo/add';
		var dataToPost = {
				'MaTruSo': stationNo,
				'DiaChiTruSo': address
		}

		var jsonToPost = JSON.stringify(dataToPost);
		//console.log(jsonToPost);

		$.ajax({
			type: 'POST',
			url: _url,
			data: jsonToPost,
			dataType: 'json',
			contentType: 'application/json',
			timeout: 30 * 1000
		})
			.done(function (data, textStatus, jqXHR) {
				$('#stationList').empty();
				getTruSo();
			})
			.fail(function (jqXHR, textStatus, error) {
				console.log(error);
			});
	});
	
	$('#btnUpdateTruSo').on('click', function () {
		var stationNo = $('#txtTruSo').val();
		var address = $('#txtDiaChiTruSo').val();
		
		var _url = 'http://localhost:2796/api/TruSo/' + stationNo;
		var dataToPost = {
				'MaTruSo': stationNo,
				'DiaChiTruSo': address
		}

		var jsonToPost = JSON.stringify(dataToPost);

		$.ajax({
			type: 'PUT',
			url: _url,
			data: jsonToPost,
			dataType: 'json',
			contentType: 'application/json',
			timeout: 30 * 1000
		})
			.done(function (data, textStatus, jqXHR) {
				console.log(data);
				console.log(jqXHR);
				$('#stationList').empty();
				getTruSo();

			})
			.fail(function (jqXHR, textStatus, error) {
				console.log(error);
			});
	});

	  function getTruSoAction(stationNo, address){
	  $("#btnUpdateTruSo").prop("disabled",false);
			$("#btnAddTruSo").prop("disabled",true);
						$('#txtTruSo').val(stationNo);
						$('#txtDiaChiTruSo').val(address);
	  };
	  
	  function deleteTruSoAction(stationNo){

		var _url = 'http://localhost:2796/api/TruSo/' + stationNo;
		var dataToPost = {
				'MaTruSo': stationNo,
				'DiaChiTruSo': ''
		}

		var jsonToPost = JSON.stringify(dataToPost);

		$.ajax({
			type: 'DELETE',
			url: _url,
			data: jsonToPost,
			dataType: 'json',
			contentType: 'application/json',
			timeout: 30 * 1000
		})
			.done(function (data, textStatus, jqXHR) {
				$('#stationList').empty();
				getTruSo();
			})
			.fail(function (jqXHR, textStatus, error) {
				console.log(error);
			});
	};
	
// Quản lý cơ sở
	function getCoSo(){
		var _url = 'http://localhost:2796/api/CoSo';
	   var maxstation = 1;
		$.ajax({
			url: _url,
			dataType: 'json',
			timeout: 30 * 1000
		})
		.done(function (data) {
			$('#stationList1').empty();
			$.each(data, function (index, dm) {
				var tr = '<tr>' +
							'<td>' + dm.MaCS + '</td>' +
							'<td>' + dm.DiaChiCS + '</td>' +
							'<td>' + dm.MaTruSo + '</td>' +
							'<td>' + dm.NguoiQuanLy + '</td>' +
							'<td><a href="#" onclick="getCoSoAction('+ dm.MaCS +', '+ dm.DiaChiCS +', '+ dm.MaTruSo +', '+ dm.NguoiQuanLy +')" ><img src="images/user_edit.png" alt="" title="" border="0" /></a></td>' +
							'<td><a href="#" onclick="deleteCoSoAction('+ dm.MaCS +')"><img src="images/trash.png" alt="" title="" border="0" /></a></td>' +
						+'</tr>';

				$('#stationList1').append(tr);
				maxstation = dm.MaCS;
			});
			maxstation = maxstation + 1;
			$('#txtMaCoSo').val(maxstation);	
			$('#txtDiaChiCoSo').val("");
			$('#txtTruSo1').val("");
			$('#txtNguoiQuanLy').val("");
			$("#btnUpdateCoSo").prop("disabled",true);
			$("#btnAddCoSo").prop("disabled",false);
		})
		.fail(function (jqXHR, textStatus, error) {
			console.log(jqXHR);
			console.log(jqXHR.statusCode);
		});
	};
	
	$(function () {

	});

	$('#btnAddCoSo').on('click', function () {
		var maCoSo = $('#txtMaCoSo').val();
		var diaChi = $('#txtDiaChiCoSo').val();
		var truSo = $('#txtTruSo1').val();
		var nguoiQuanLy = $('#txtNguoiQuanLy').val();
		
		var _url = 'http://localhost:2796/api/CoSo/add';
		var dataToPost = {
				'MaCS': maCoSo,
				'DiaChiCS': diaChi,
				'MaTruSo': truSo,
				'NguoiQuanLy': nguoiQuanLy
		}

		var jsonToPost = JSON.stringify(dataToPost);

		$.ajax({
			type: 'POST',
			url: _url,
			data: jsonToPost,
			dataType: 'json',
			contentType: 'application/json',
			timeout: 30 * 1000
		})
			.done(function (data, textStatus, jqXHR) {
				$('#stationList').empty();
				getCoSo();
			})
			.fail(function (jqXHR, textStatus, error) {
				console.log(error);
			});
	});
	
	$('#btnUpdateCoSo').on('click', function () {
		var maCoSo = $('#txtMaCoSo').val();
		var diaChi = $('#txtDiaChiCoSo').val();
		var truSo = $('#txtTruSo1').val();
		var nguoiQuanLy = $('#txtNguoiQuanLy').val();
		
		var _url = 'http://localhost:2796/api/CoSo/' + maCoSo;
		var dataToPost = {
				'MaCS': maCoSo,
				'DiaChiCS': diaChi,
				'MaTruSo': truSo,
				'NguoiQuanLy': nguoiQuanLy
		}

		var jsonToPost = JSON.stringify(dataToPost);

		$.ajax({
			type: 'PUT',
			url: _url,
			data: jsonToPost,
			dataType: 'json',
			contentType: 'application/json',
			timeout: 30 * 1000
		})
			.done(function (data, textStatus, jqXHR) {
				console.log(data);
				console.log(jqXHR);
				$('#stationList').empty();
				getCoSo();

			})
			.fail(function (jqXHR, textStatus, error) {
				console.log(error);
			});
	});

	  function getCoSoAction(maCoSo, diaChi, truSo, nguoiQuanLy){
			$("#btnUpdateCoSo").prop("disabled",false);
			$("#btnAddCoSo").prop("disabled",true);
			$('#txtMaCoSo').val(maCoSo);
			$('#txtDiaChiCoSo').val(diaChi);
			$('#txtTruSo1').val(truSo);
			$('#txtNguoiQuanLy').val(nguoiQuanLy);
	  };
	  
	  function deleteCoSoAction(maCoSo){

		var _url = 'http://localhost:2796/api/CoSo/' + maCoSo;
		var dataToPost = {
				'MaCS': maCoSo,
				'DiaChiCS': '',
				'MaTruSo': '',
				'NguoiQuanLy': ''
		}

		var jsonToPost = JSON.stringify(dataToPost);
		//console.log(jsonToPost);

		$.ajax({
			type: 'DELETE',
			url: _url,
			data: jsonToPost,
			dataType: 'json',
			contentType: 'application/json',
			timeout: 30 * 1000
		})
			.done(function (data, textStatus, jqXHR) {
				$('#stationList').empty();
				getCoSo();
			})
			.fail(function (jqXHR, textStatus, error) {
				console.log(error);
			});
	};

</script>


</body>
</html>
